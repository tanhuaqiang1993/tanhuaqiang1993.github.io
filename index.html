<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="java 后端开发">
<meta property="og:type" content="website">
<meta property="og:title" content="Tanhq&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Tanhq&#39;s Blog">
<meta property="og:description" content="java 后端开发">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tanhq&#39;s Blog">
<meta name="twitter:description" content="java 后端开发">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Tanhq's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

	
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tanhq's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">脚踏实地行，海阔天空飞</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程表
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      
        
        <li class="menu-item menu-item-something">
          <a href="/something" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            有料
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/06/spring-ioc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/06/spring-ioc/" itemprop="url">spring-IOC/DI</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-06T16:37:08+08:00">
                2018-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="DI-依赖注入"><a href="#DI-依赖注入" class="headerlink" title="DI:依赖注入"></a>DI:依赖注入</h1><p>1,UserServiceImpl的add()方法依赖于熟悉userDao，这就是一种依赖注入<br>2,UserServiceImpl userServiceImpl = (UserServiceImpl) factory.getBean(“userService”);userServiceImpl对象<br>依赖于<bean id="userService" class="com.sxt.manager.impl.UserServiceImpl">com.sxt.manager.impl.UserServiceImpl对象的注入，<br>然后根据id来获取bean，所以这就是依赖注入的意思。</bean></p>
<p><img src="/2018/05/06/spring-ioc/springdi1.png" alt="结果"><br><img src="/2018/05/06/spring-ioc/springdi2.png" alt="结果"></p>
<h1 id="IOC-控制反转"><a href="#IOC-控制反转" class="headerlink" title="IOC:控制反转"></a>IOC:控制反转</h1><p>1，private UserDao userDao = new UserDaoImpl();一开始我们是自己来new对象，现在是交给spring容器，由spring容器来帮我们实现，反转给spring容器<br>2，一开始我们写的是具体的实现，现在我们依赖于接口，我们将其反转到接口的实现上。我们是在控制整个接口，而不是具体实现上。</p>
<p><img src="/2018/05/06/spring-ioc/springIOC1.png" alt="结果"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/03/imitate-spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/03/imitate-spring/" itemprop="url">利用反射模拟sprig</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-03T09:21:54+08:00">
                2018-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>为了加深对spring的理解，我们手动模拟一下spring的实现</p>
<h1 id="自定义一个xml文件，放入bean对象"><a href="#自定义一个xml文件，放入bean对象" class="headerlink" title="自定义一个xml文件，放入bean对象"></a>自定义一个xml文件，放入bean对象</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans&gt;</span><br><span class="line">	&lt;bean id=&quot;userDao&quot; class=&quot;com.sxt.dao.impl.UserDaoImpl&quot;&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;userService&quot; class=&quot;com.sxt.manager.impl.UserServiceImpl&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;userDao&quot; ref=&quot;userDao&quot;&gt;&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<h1 id="以下是userService接口和userServiceImpl实现类-userDao和userDaoImpl类，以及User对象"><a href="#以下是userService接口和userServiceImpl实现类-userDao和userDaoImpl类，以及User对象" class="headerlink" title="以下是userService接口和userServiceImpl实现类,userDao和userDaoImpl类，以及User对象"></a>以下是userService接口和userServiceImpl实现类,userDao和userDaoImpl类，以及User对象</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line">	private String username;</span><br><span class="line">	private String password;</span><br><span class="line">	//get，set方法</span><br><span class="line">&#125;</span><br><span class="line">public class UserServiceImpl implements UserService&#123;</span><br><span class="line">	private UserDao userDao;</span><br><span class="line">	public UserDao getUserDao() &#123;</span><br><span class="line">		return userDao;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setUserDao(UserDao userDao) &#123;</span><br><span class="line">		this.userDao = userDao;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public void add(User user) &#123;</span><br><span class="line">		userDao.add(user);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">public class UserDaoImpl implements UserDao&#123;</span><br><span class="line">	@Override</span><br><span class="line">	public void add(User user) &#123;</span><br><span class="line">		System.out.println(&quot;a user add!&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="然后我们利用jdom来解析xml文件"><a href="#然后我们利用jdom来解析xml文件" class="headerlink" title="然后我们利用jdom来解析xml文件"></a>然后我们利用jdom来解析xml文件</h1><p>利用反射将对象引用和对象放入map集合中，再利用反射将dao接口的实现类注入到service接口实现类的属性（set方法）中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">public class ClassPathXmlAppliactionContext implements BeanFactory&#123;</span><br><span class="line">	</span><br><span class="line">	private Map&lt;Object,Object&gt; beanMap = new HashMap&lt;Object,Object&gt;();</span><br><span class="line">	</span><br><span class="line">	public ClassPathXmlAppliactionContext()&#123;</span><br><span class="line">		SAXBuilder sb=new SAXBuilder();//解析xml的SAXBuiler对象   </span><br><span class="line">	    //构造文档对象 </span><br><span class="line">	    Document doc = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			doc = sb.build(Sample.class.getClassLoader().getResourceAsStream(&quot;bean.xml&quot;));</span><br><span class="line">		&#125; catch (JDOMException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;  </span><br><span class="line">	    Element root=doc.getRootElement(); //获取根元素  </span><br><span class="line">	    List list=root.getChildren(&quot;bean&quot;);//取名字为bean的所有元素   </span><br><span class="line">	    for(int i=0;i&lt;list.size();i++)&#123;</span><br><span class="line">	    	Element element=(Element)list.get(i);   </span><br><span class="line">			String id=element.getAttributeValue(&quot;id&quot;); //获取id  </span><br><span class="line">			String clazz=element.getAttributeValue(&quot;class&quot;); //获取class</span><br><span class="line">			Object obj = null;</span><br><span class="line">			try &#123;</span><br><span class="line">				//利用反射实例化对象</span><br><span class="line">				obj = Class.forName(clazz).newInstance();</span><br><span class="line">			&#125; catch (InstantiationException | IllegalAccessException | ClassNotFoundException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			beanMap.put(id, obj);//将对象放入beanMap中</span><br><span class="line">			</span><br><span class="line">			for (Element propertyElement : (List&lt;Element&gt;)element.getChildren(&quot;property&quot;)) &#123;</span><br><span class="line">				String name = propertyElement.getAttributeValue(&quot;name&quot;);//userDao</span><br><span class="line">				String ref = propertyElement.getAttributeValue(&quot;ref&quot;);//userDao</span><br><span class="line">				Object refObject = beanMap.get(ref);//userDaoImpl</span><br><span class="line">				//方法名 setUserDao</span><br><span class="line">				String methodName = &quot;set&quot;+name.substring(0, 1).toUpperCase()+name.substring(1);</span><br><span class="line">				try &#123;</span><br><span class="line">					//获取方法，然后调用方法</span><br><span class="line">					/* public class UserServiceImpl implements UserService</span><br><span class="line">					 * refObject.getClass().getInterfaces()[0]:</span><br><span class="line">					 * 返回的是UserDaoImpl类所实现的所有接口对象的一个数组，然后取第一个接口</span><br><span class="line">					 * 获取的是UserService接口的Class对象</span><br><span class="line">					 * 根据类中的方法名和方法的形参列表来获取方法</span><br><span class="line">					 */</span><br><span class="line">					Method method = obj.getClass().getMethod(methodName, refObject.getClass().getInterfaces()[0]);</span><br><span class="line">					method.invoke(obj, refObject);//obj是方法所在的类对象，refObject是方法的形参列表(接口的实现类)</span><br><span class="line">				&#125; catch (NoSuchMethodException | SecurityException | IllegalAccessException </span><br><span class="line">						| IllegalArgumentException | InvocationTargetException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public Object getBean(Object obj) &#123;</span><br><span class="line">		return beanMap.get(obj);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="根据类中的方法名和方法的形参列表来获取方法"><a href="#根据类中的方法名和方法的形参列表来获取方法" class="headerlink" title="根据类中的方法名和方法的形参列表来获取方法"></a>根据类中的方法名和方法的形参列表来获取方法</h1><pre><code>/* public class UserServiceImpl implements UserService
 * refObject.getClass().getInterfaces()[0]:
 * 返回的是UserDaoImpl类所实现的所有接口对象的一个数组，然后取第一个接口
 * 获取的是UserService接口的Class对象
 */
Method method = obj.getClass().getMethod(methodName, refObject.getClass().getInterfaces()[0]);
//obj是方法所在的类对象，refObject是方法的形参列表(接口的实现类)
method.invoke(obj, refObject);
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/02/json/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/02/json/" itemprop="url">JSONObject put(),accumulate(),element()的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-02T14:35:28+08:00">
                2018-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1,public Object put (Object key, Object value),如果此JSONObject对象之前存在一个value在这个key下，当前的value会替换掉之前的value<br>2,public JSONObject accumulate (String key, Object value) 累积value到这个key下<br>3,public JSONObject element (String key, Object value) 和put()方法类似</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">package com.sxt.test.json;</span><br><span class="line"></span><br><span class="line">import net.sf.json.JSONObject;</span><br><span class="line"></span><br><span class="line">public class JsonTest &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		JSONObject object = new JSONObject();</span><br><span class="line">		//public Object put (Object key, Object value) </span><br><span class="line">		//如果此JSONObject对象之前存在一个value在这个key下，当前的value会替换掉之前的value</span><br><span class="line">		object.put(&quot;aaa&quot;, &quot;111&quot;);</span><br><span class="line">		object.put(&quot;aaa&quot;, &quot;222&quot;);</span><br><span class="line">		object.put(&quot;bbb&quot;, &quot;333&quot;);</span><br><span class="line">		object.put(&quot;ccc&quot;, &quot;444&quot;);</span><br><span class="line">		System.out.println(object.toString());//&#123;&quot;aaa&quot;:&quot;222&quot;,&quot;ccc&quot;:&quot;444&quot;,&quot;bbb&quot;:&quot;333&quot;&#125;</span><br><span class="line">		</span><br><span class="line">		JSONObject object2 = new JSONObject();</span><br><span class="line">		//public JSONObject accumulate (String key, Object value) 累积value到这个key下</span><br><span class="line">		object2.accumulate(&quot;aaa&quot;, &quot;111&quot;);</span><br><span class="line">		object2.accumulate(&quot;aaa&quot;, &quot;222&quot;);</span><br><span class="line">		object2.accumulate(&quot;aaa&quot;, &quot;222&quot;);//累积value到这个key下</span><br><span class="line">		object2.accumulate(&quot;bbb&quot;, &quot;333&quot;);</span><br><span class="line">		object2.accumulate(&quot;ccc&quot;, &quot;444&quot;);</span><br><span class="line">		//&#123;&quot;aaa&quot;:[&quot;111&quot;,&quot;222&quot;,&quot;222&quot;],&quot;ccc&quot;:&quot;444&quot;,&quot;bbb&quot;:&quot;333&quot;&#125;</span><br><span class="line">		System.out.println(object2.toString());</span><br><span class="line">		</span><br><span class="line">		JSONObject object3 = new JSONObject();</span><br><span class="line">		//public JSONObject element (String key, Object value) </span><br><span class="line">		object3.element(&quot;aaa&quot;, 111);</span><br><span class="line">		object3.element(&quot;aaa&quot;, 222);//当前的value会替换掉之前的value</span><br><span class="line">		object3.element(&quot;bbb&quot;, 333);</span><br><span class="line">		object3.element(&quot;ccc&quot;, 444);</span><br><span class="line">		//&#123;&quot;aaa&quot;:222,&quot;ccc&quot;:444,&quot;bbb&quot;:333&#125;</span><br><span class="line">		System.out.println(object3);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/01/mybatisEhcache/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/01/mybatisEhcache/" itemprop="url">mybatis二级缓存</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-01T21:03:31+08:00">
                2018-05-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="mybatis二级缓存的配置需要注意以下三点："><a href="#mybatis二级缓存的配置需要注意以下三点：" class="headerlink" title="mybatis二级缓存的配置需要注意以下三点："></a>mybatis二级缓存的配置需要注意以下三点：</h1><pre><code>1，加入缓存插件包（二级缓存为外部缓存插件）
2，配置缓存策略，需要在mapper.xml文件中加入
    &lt;!-- 具体的缓存，由EhcacheCache这个类提供 --&gt;
    &lt;cache readOnly=&quot;true&quot; type=&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;&gt;&lt;/cache&gt;
3，配置ehcache.xml文件，放在src目录下
</code></pre><h1 id="ehcache-xml文件"><a href="#ehcache-xml文件" class="headerlink" title="ehcache.xml文件"></a>ehcache.xml文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;ehcache xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; </span><br><span class="line">	xsi:noNamespaceSchemaLocation=&quot;../config/ehcache.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- 内存保存不下，就持久化到硬盘中  --&gt;</span><br><span class="line">   	&lt;diskStore path=&quot;d:/test&quot;/&gt;</span><br><span class="line">   	</span><br><span class="line">   	&lt;!-- </span><br><span class="line">	   	defaultCache ： 默认的管理策略</span><br><span class="line">	   	以下属性是必须的：</span><br><span class="line">		name： Cache的名称，必须是唯一的(ehcache会把这个cache放到HashMap里)。</span><br><span class="line">		maxElementsInMemory： 在内存中缓存的element的最大数目。 </span><br><span class="line">		maxElementsOnDisk： 在磁盘上缓存的element的最大数目，默认值为0，表示不限制。 </span><br><span class="line">		eternal： 设定缓存的elements是否永远不过期。如果为true，则缓存的数据始终有效，如果为false那么还要根据timeToIdleSeconds，timeToLiveSeconds判断。 </span><br><span class="line">		overflowToDisk： 如果内存中数据超过内存限制，是否要缓存到磁盘上。</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;defaultCache</span><br><span class="line">            maxElementsInMemory=&quot;10&quot;</span><br><span class="line">            eternal=&quot;true&quot;</span><br><span class="line">            timeToIdleSeconds=&quot;120&quot;</span><br><span class="line">            timeToLiveSeconds=&quot;120&quot;</span><br><span class="line">            overflowToDisk=&quot;true&quot;  </span><br><span class="line">            maxElementsOnDisk=&quot;10000000&quot;</span><br><span class="line">            diskPersistent=&quot;false&quot;</span><br><span class="line">            diskExpiryThreadIntervalSeconds=&quot;120&quot;</span><br><span class="line">            memoryStoreEvictionPolicy=&quot;LRU&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">&lt;/ehcache&gt;</span><br></pre></td></tr></table></figure>
<h1 id="测试类"><a href="#测试类" class="headerlink" title="测试类"></a>测试类</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">	 * 测试二级缓存，二级缓存是SessionFactory级别的缓存</span><br><span class="line">	 * 只有将一级缓存中的数据清空时，才会将一级缓存中的数据更新到二级缓存</span><br><span class="line">	 * 二级缓存中的数据是多个不同session共享的数据</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testSecondCache()&#123;</span><br><span class="line">		//3产生SqlSession对象</span><br><span class="line">		SqlSession session = ssf.openSession();</span><br><span class="line">		OrdersDetailsMapper mapper = session.getMapper(OrdersDetailsMapper.class);</span><br><span class="line">		OrdersDetails order = new OrdersDetails();</span><br><span class="line">		order.setOname(&quot;iphone&quot;);</span><br><span class="line">		order.setOcount(4);</span><br><span class="line">		List&lt;OrdersDetails&gt; list = mapper.loadOrdersDetails(order);</span><br><span class="line">		for (OrdersDetails ordersDetails : list) &#123;</span><br><span class="line">			System.out.println(ordersDetails.toString());</span><br><span class="line">		&#125;</span><br><span class="line">//		session.commit();</span><br><span class="line">		session.close();//只有将一级缓存中的数据清空时，才会将一级缓存中的数据更新到二级缓存</span><br><span class="line">		try &#123;</span><br><span class="line">			Thread thread = Thread.currentThread();</span><br><span class="line">			thread.sleep(1000);</span><br><span class="line">		&#125; catch (InterruptedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		//开启两个session，验证数据是否缓存到二级缓存</span><br><span class="line">		SqlSession session2 = ssf.openSession();</span><br><span class="line">		OrdersDetailsMapper mapper2 = session2.getMapper(OrdersDetailsMapper.class);</span><br><span class="line">		OrdersDetails order2 = new OrdersDetails();</span><br><span class="line">		order2.setOname(&quot;iphone&quot;);</span><br><span class="line">		order2.setOcount(4);</span><br><span class="line">		List&lt;OrdersDetails&gt; list2 = mapper2.loadOrdersDetails(order2);</span><br><span class="line">		for (OrdersDetails ordersDetails : list2) &#123;</span><br><span class="line">			System.out.println(ordersDetails.toString());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h1 id="一级缓存："><a href="#一级缓存：" class="headerlink" title="一级缓存："></a>一级缓存：</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">	 * 测试一级缓存</span><br><span class="line">	 * 1,数据进行查询的时候，数据自动放入一级缓存</span><br><span class="line">	 * 2,提交session和关闭session，一级缓存数据会消失</span><br><span class="line">	 * 数据进行查询，缓存数据会保存在map中，key:由namespace+id+params(查询条件)+limit(分页结果集)等条件决定</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testFirstCache()&#123;</span><br><span class="line">		//3产生SqlSession对象</span><br><span class="line">		SqlSession session = ssf.openSession();</span><br><span class="line">		OrdersDetailsMapper mapper = session.getMapper(OrdersDetailsMapper.class);</span><br><span class="line">		OrdersDetails order = new OrdersDetails();</span><br><span class="line">		order.setOname(&quot;iphone&quot;);</span><br><span class="line">		order.setOcount(4);</span><br><span class="line">		//第一次查询</span><br><span class="line">		List&lt;OrdersDetails&gt; list = mapper.loadOrdersDetails(order);</span><br><span class="line">		for (OrdersDetails ordersDetails : list) &#123;</span><br><span class="line">			System.out.println(ordersDetails.toString());</span><br><span class="line">		&#125;</span><br><span class="line">//		session.commit();</span><br><span class="line">//		session.close();</span><br><span class="line">		//第二次查询</span><br><span class="line">		OrdersDetails order2 = new OrdersDetails();</span><br><span class="line">		order2.setOname(&quot;iphone&quot;);</span><br><span class="line">		order2.setOcount(4);</span><br><span class="line">		List&lt;OrdersDetails&gt; list2 = mapper.loadOrdersDetails(order2);</span><br><span class="line">		for (OrdersDetails ordersDetails : list2) &#123;</span><br><span class="line">			System.out.println(ordersDetails.toString());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h1 id="缓存插件包"><a href="#缓存插件包" class="headerlink" title="缓存插件包"></a>缓存插件包</h1><p><img src="/2018/05/01/mybatisEhcache/ehcache.png" alt="结果"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/30/hashmap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/30/hashmap/" itemprop="url">自己手动实现HashMap</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-30T21:56:01+08:00">
                2018-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>HashMap的底层实现主要是基于数组和链表来实现的，HashMap中通过key的hashCode来计算hash值的，由这个hash值计算在数组中的位置，将新插入的元素放到数组的这个位置，如果新插入的元素的hash值跟这个位置上已有元素的hash值相同，就会出现hash冲突，这时候，就在该位置通过链表来插入新的元素</p>
<p><img src="/2018/04/30/hashmap/hashmap.png" alt="结果"></p>
<h1 id="Map接口"><a href="#Map接口" class="headerlink" title="Map接口"></a>Map接口</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public interface Map &#123;</span><br><span class="line">	int size();</span><br><span class="line">	boolean isEmpty();</span><br><span class="line">	Object get(Object key);</span><br><span class="line">	Object put(Object key, Object value);</span><br><span class="line">	interface Entry&#123;</span><br><span class="line">		Object getKey();</span><br><span class="line">		Object getValue();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="HashMap的实现"><a href="#HashMap的实现" class="headerlink" title="HashMap的实现"></a>HashMap的实现</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 数组加链表的结构</span><br><span class="line"> */</span><br><span class="line">public class HashMap implements Map &#123;</span><br><span class="line">	//默认容量16</span><br><span class="line">	private final int DEFAULT_CAPACITY = 16;</span><br><span class="line">	//内部存储结构，数组</span><br><span class="line">	Node[] table = new Node[DEFAULT_CAPACITY];</span><br><span class="line">	</span><br><span class="line">	private int size = 0;</span><br><span class="line">	</span><br><span class="line">	//集合元素个数</span><br><span class="line">	@Override</span><br><span class="line">	public int size() &#123;</span><br><span class="line">		return size;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public boolean isEmpty() &#123;</span><br><span class="line">		return size == 0;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 取值</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public Object get(Object key) &#123;</span><br><span class="line">		int hashValue = hash(key);//获取key的hash值</span><br><span class="line">		int index = indexFor(hashValue, table.length);//求key所在数组的位置</span><br><span class="line">		for (Node node = table[index]; node != null ; node = node.next) &#123;</span><br><span class="line">			//hash值相同，key也相同，则返回该节点的value</span><br><span class="line">			if (node.hash == hashValue &amp;&amp; node.key.equals(key)) &#123;</span><br><span class="line">				return node.value;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return null;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 存值</span><br><span class="line">	 * 关于返回值：如果当前有一个相同的key，那么返回值是之前key对应的value,即oldValue</span><br><span class="line">	 * 			如果是新的key，则返回null</span><br><span class="line">	 * hashset中的add方法调用的是hashmap的put方法，通过判断put方法的返回值是否为空，</span><br><span class="line">	 * 来保证hashset的值不重复</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public Object put(Object key, Object value) &#123;</span><br><span class="line">		int hashValue = hash(key);//获取key的hash值</span><br><span class="line">		int index = indexFor(hashValue, table.length);//求key所在数组的位置</span><br><span class="line">		//index位置已经有数据了</span><br><span class="line">		for(Node node = table[index]; node != null ; node = node.next)&#123;</span><br><span class="line">			//链表中已有该key，则替换对应的value值，并将旧的oldValue返回</span><br><span class="line">			if (node.hash == hashValue &amp;&amp; node.key.equals(key)) &#123;</span><br><span class="line">				Object oldVaue = node.value;</span><br><span class="line">				node.value = value;</span><br><span class="line">				return oldVaue;</span><br><span class="line">			&#125; </span><br><span class="line">		&#125;</span><br><span class="line">		/**</span><br><span class="line">		 * 如果index位置没有数据，或是index位置有数据，但是不存在相同的key，则需要新增node</span><br><span class="line">		 */</span><br><span class="line">		addEntry(hashValue, key, value, index);</span><br><span class="line">		return null;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void addEntry(int hash, Object key, Object value, int i)&#123;</span><br><span class="line">		//集合中元素增加时，需要判断集合是否需要扩容</span><br><span class="line">		if(++size == table.length)&#123;</span><br><span class="line">			Node[] newTable = new Node[table.length * 2];</span><br><span class="line">			System.arraycopy(table, 0, newTable, 0, table.length);//数组拷贝</span><br><span class="line">			table = newTable;</span><br><span class="line">		&#125;</span><br><span class="line">		/*</span><br><span class="line">		 * 当i位置为null时，将null作为新增node的下一个节点，新增node放在table[i]处，这样是没问题的</span><br><span class="line">		 * 当i位置不为null时，将新增节点放在原始节点的前面，所以新增node的next指向原始i位置的node</span><br><span class="line">		 * 所以2者结合起来，使用同一行代码</span><br><span class="line">		 */</span><br><span class="line">		Node node = table[i];//获取当前位置的node</span><br><span class="line">		//生成一个新的node,并放到数组的index</span><br><span class="line">		table[i] = new Node(hash, key, value, node);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public int hash(Object key)&#123;</span><br><span class="line">		return key.hashCode();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public int indexFor(int hashValue, int length)&#123;</span><br><span class="line">		return hashValue % length;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Node结点"><a href="#Node结点" class="headerlink" title="Node结点"></a>Node结点</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 数组中的元素结点</span><br><span class="line"> * @author tanhq</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">public class Node implements Map.Entry&#123;</span><br><span class="line">	int hash;</span><br><span class="line">	Object key;</span><br><span class="line">	Object value;</span><br><span class="line">	Node next;//下一个结点</span><br><span class="line">	public Node(int hash, Object key, Object value, Node next) &#123;</span><br><span class="line">		super();</span><br><span class="line">		this.hash = hash;</span><br><span class="line">		this.key = key;</span><br><span class="line">		this.value = value;</span><br><span class="line">		this.next = next;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public Object getKey() &#123;</span><br><span class="line">		return key;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public Object getValue() &#123;</span><br><span class="line">		return value;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="测试类"><a href="#测试类" class="headerlink" title="测试类"></a>测试类</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class TestMyHashMap &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		//每个java类都需要至少有一个构造方法，所以对于代码里没有构造方法的，就自动生成一个无参的</span><br><span class="line">		HashMap hashMap=new HashMap();</span><br><span class="line">		hashMap.put(&quot;aaa&quot;, &quot;1111&quot;);</span><br><span class="line">		hashMap.put(&quot;bbb&quot;, &quot;2222&quot;);</span><br><span class="line">		hashMap.put(&quot;ccc&quot;, &quot;3333&quot;);</span><br><span class="line">		hashMap.put(&quot;ddd&quot;, &quot;4444&quot;);</span><br><span class="line">		hashMap.put(&quot;eee&quot;, &quot;5555&quot;);</span><br><span class="line">		hashMap.put(&quot;fff&quot;, &quot;6666&quot;);</span><br><span class="line">		hashMap.put(&quot;ddd&quot;, &quot;7777&quot;);</span><br><span class="line">		System.out.println(hashMap.get(&quot;ccc&quot;));</span><br><span class="line">		System.out.println(hashMap.get(&quot;ddd&quot;));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/30/Deque-Queue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/30/Deque-Queue/" itemprop="url">Deque和Queue</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-30T16:17:52+08:00">
                2018-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Deque是双向队列，而Queue是对列-Duque比Stack和Vector更丰富"><a href="#Deque是双向队列，而Queue是对列-Duque比Stack和Vector更丰富" class="headerlink" title="Deque是双向队列，而Queue是对列;Duque比Stack和Vector更丰富"></a>Deque是双向队列，而Queue是对列;Duque比Stack和Vector更丰富</h1><pre><code>public class LinkedList&lt;E&gt;
    extends AbstractSequentialList&lt;E&gt;
    implements List&lt;E&gt;, Deque&lt;E&gt;, Cloneable, java.io.Serializable

public interface Deque&lt;E&gt; extends Queue&lt;E&gt;
public interface Queue&lt;E&gt; extends Collection&lt;E&gt;
</code></pre><h1 id="ArrayDeque模拟栈-使用push-和pop"><a href="#ArrayDeque模拟栈-使用push-和pop" class="headerlink" title="ArrayDeque模拟栈,使用push()和pop()"></a>ArrayDeque模拟栈,使用push()和pop()</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">	//ArrayDeque模拟栈</span><br><span class="line">	Deque&lt;String&gt; stack = new ArrayDeque&lt;String&gt;();</span><br><span class="line">	stack.push(&quot;aaa&quot;);</span><br><span class="line">	stack.push(&quot;bbb&quot;);</span><br><span class="line">	stack.push(&quot;ccc&quot;);</span><br><span class="line">	//访问，不pop出元素</span><br><span class="line">	System.out.println(stack.peek());</span><br><span class="line">	System.out.println(stack);</span><br><span class="line">	</span><br><span class="line">	//pop出元素</span><br><span class="line">	System.out.println(stack.pop());</span><br><span class="line">	System.out.println(stack);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ArrayDeque模拟队列-使用offer-和poll"><a href="#ArrayDeque模拟队列-使用offer-和poll" class="headerlink" title="ArrayDeque模拟队列,使用offer()和poll()"></a>ArrayDeque模拟队列,使用offer()和poll()</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">	//模拟Queue队列</span><br><span class="line">	Deque&lt;String&gt; queue = new ArrayDeque&lt;String&gt;();</span><br><span class="line">	//依次将3个元素加入队列</span><br><span class="line">	queue.offer(&quot;aaa&quot;);</span><br><span class="line">	queue.offer(&quot;bbb&quot;);</span><br><span class="line">	queue.offer(&quot;ccc&quot;);</span><br><span class="line">	System.out.println(queue);</span><br><span class="line">	//访问，不poll元素</span><br><span class="line">	System.out.println(queue.peek());</span><br><span class="line">	System.out.println(queue);</span><br><span class="line">	</span><br><span class="line">	//poll元素</span><br><span class="line">	System.out.println(queue.poll());</span><br><span class="line">	System.out.println(queue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/30/hashcode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/30/hashcode/" itemprop="url">hashcode详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-30T14:02:17+08:00">
                2018-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一、hash和hash表"><a href="#一、hash和hash表" class="headerlink" title="一、hash和hash表"></a>一、hash和hash表</h1><pre><code>Hash：散列，就是把任意长度的输入通过散列算法变换成固定长度的输出。
简单的说就是一种将任意长度的消息压缩到某一固定长度的消息摘要的函数

hash是一个函数，该函数中的实现就是一种算法，就是通过一系列的算法来得到一个hash值
hash表，通过hash算法得到的hash值就在这张hash表中，也就是说，hash表就是所有的hash值组成的
</code></pre><h1 id="二、hashcode：哈希值"><a href="#二、hashcode：哈希值" class="headerlink" title="二、hashcode：哈希值"></a>二、hashcode：哈希值</h1><pre><code>hashcode就是通过hash函数得来的，通俗的说，就是通过某一种算法得到的，hashcode就是在hash表中有对应的位置
</code></pre><h1 id="三、每个对象都有hashcode，对象的hashcode怎么得来的呢？"><a href="#三、每个对象都有hashcode，对象的hashcode怎么得来的呢？" class="headerlink" title="三、每个对象都有hashcode，对象的hashcode怎么得来的呢？"></a>三、每个对象都有hashcode，对象的hashcode怎么得来的呢？</h1><pre><code>首先一个对象肯定有物理地址，对象的物理地址跟这个hashcode地址不一样，
hashcode代表对象的地址说的是对象在hash表中的位置，物理地址说的对象存放在内存中的地址
那么对象如何得到hashcode呢？通过对象的内部地址(也就是物理地址)转换成一个整数，然后该整数通过hash函数的算法就得到了hashcode
所以，hashcode是什么呢？就是在hash表中对应的位置
举个例子，hash表中有 hashcode为1、hashcode为2、(...)3、4、5、6、7、8这样八个位置，有一个对象A，A的物理地址转换为一个整数17(这是假如)，就通过直接取余算法，17%8=1，那么A的hashcode就为1，且A就在hash表中1的位置
</code></pre><h1 id="四、hashcode有什么作用呢？"><a href="#四、hashcode有什么作用呢？" class="headerlink" title="四、hashcode有什么作用呢？"></a>四、hashcode有什么作用呢？</h1><pre><code>HashCode的存在主要是为了查找的快捷性，HashCode是用来在散列存储结构中确定对象的存储地址的(后半句说的用hashcode来代表对象就是在hash表中的位置)
为什么hashcode就查找的更快，比如：我们有一个能存放1000个数这样大的内存中，在其中要存放1000个不一样的数字，用最笨的方法，就是存一个数字，就遍历一遍，看有没有相同的数，
当存了900个数字，开始存901个数字的时候，就需要跟900个数字进行对比，这样就很麻烦，很是消耗时间，用hashcode来记录对象的位置，来看一下。
hash表中有1、2、3、4、5、6、7、8个位置，存第一个数，1%8=1，hashcode为1，该数就放在hash表中1的位置，存到100个数字，hash表中8个位置会有很多数字了，1中可能有13个数字（1,9...81,89,97），
存101个数字时，他先查hashcode值对应的位置，101%8=5,那么就有12个数字和他的hashcode相同，他只需要跟这12个数字相比较(equals)，如果没有一个值和他相同，那么就放在5这个位置，
这样比较的次数就少了很多，实际上hash表中有很多位置，这里只是举例只有8个，所以比较的次数会让你觉得也挺多的，实际上，如果hash表很大，那么比较的次数就很少很少了。  
通过对原始方法和使用hashcode方法进行对比，我们就知道了hashcode的作用，并且为什么要使用hashcode了.
</code></pre><h1 id="五、equals方法和hashcode的关系？"><a href="#五、equals方法和hashcode的关系？" class="headerlink" title="五、equals方法和hashcode的关系？"></a>五、equals方法和hashcode的关系？</h1><pre><code>通过前面这个例子，大概可以知道，先通过hashcode来比较，如果hashcode相等，那么就用equals方法来比较两个对象是否相等，
用个例子说明：上面说的hash表中的8个位置，就好比8个桶，每个桶里能装很多的对象，对象A通过hash函数算法得到将它放到1号桶中，当然肯定有别的对象也会放到1号桶中，
如果对象B也通过算法分到了1号桶，那么它如何识别桶中其他对象是否和它一样呢，这时候就需要equals方法来进行筛选了。
1、如果两个对象equals相等，那么这两个对象的HashCode一定也相同
2、如果两个对象的HashCode相同，不代表两个对象就相同，只能说明这两个对象在散列存储结构中，存放于同一个位置
</code></pre><h1 id="六、如果对象的equals方法被重写，那么对象的HashCode方法也尽量重写"><a href="#六、如果对象的equals方法被重写，那么对象的HashCode方法也尽量重写" class="headerlink" title="六、如果对象的equals方法被重写，那么对象的HashCode方法也尽量重写"></a>六、如果对象的equals方法被重写，那么对象的HashCode方法也尽量重写</h1><pre><code>举个栗子：有个A类重写了equals方法，但是没有重写hashCode方法，看输出结果，对象a1和对象a2使用equals方法相等，按照上面的hashcode的用法，那么他们两个的hashcode肯定相等，
但是这里由于没重写hashcode方法，他们两个hashcode并不一样，所以，我们在重写了equals方法后，尽量也重写了hashcode方法，
通过一定的算法，使他们在equals相等时，也会有相同的hashcode值。
</code></pre><p>  <img src="/2018/04/30/hashcode/hashcode1.png" alt="结果"><br>  <img src="/2018/04/30/hashcode/hashcode3.png" alt="结果"></p>
<h1 id="总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。-—习近平在世界经济论坛2017年年会开幕式上的主旨演讲"><a href="#总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。-—习近平在世界经济论坛2017年年会开幕式上的主旨演讲" class="headerlink" title="总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。               —习近平在世界经济论坛2017年年会开幕式上的主旨演讲"></a>总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。               —习近平在世界经济论坛2017年年会开幕式上的主旨演讲</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/29/equals/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/29/equals/" itemprop="url">Java中==号与equals()方法的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-29T21:06:07+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1, ==号在比较基本数据类型 (8种基本数据类型) 时比较的是值，而用==号比较两个对象时比较的是两个对象的地址值<br>2, 在所有没有重写equals()方法的类中，调用equals()方法其实和使用==号的效果一样，也是比较的地址值<br>3, String类是重写了equals()的，先比较地址，再比较值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">int x = 10;</span><br><span class="line">int y = 10;</span><br><span class="line">String str1 = new String(&quot;abc&quot;);</span><br><span class="line">String str2 = new String(&quot;abc&quot;);</span><br><span class="line">//创建对象abc时，如果常量池中没有，就在常量池中创建一个abc对象</span><br><span class="line">String str3 = &quot;abc&quot;; </span><br><span class="line">//第二次创建时，发现常量池中有，就将引用直接指向abc，str3和str4指向同一个对像</span><br><span class="line">String str4 = &quot;abc&quot;; </span><br><span class="line"></span><br><span class="line">System.out.println(x == y); // 输出true</span><br><span class="line">System.out.println(str1 == str2); // 输出false</span><br><span class="line">System.out.println(str1.equals(str2)); // 输出true</span><br><span class="line">System.out.println(str1.equals(str3)); // 输出true</span><br><span class="line">System.out.println(str3==str4);// 比较的是对象的地址值，都在常量池中，输出true</span><br><span class="line">System.out.println(str3.equals(str4));// 输出true</span><br><span class="line"></span><br><span class="line">Student student1 = new Student(&quot;tanhq&quot;);</span><br><span class="line">Student student2 = new Student(&quot;tanhq&quot;);</span><br><span class="line">System.out.println(student1==student2); // 输出false</span><br><span class="line">//在所有没有重写equals()方法的类中，调用equals()方法其实和使用==号的效果一样，也是比较的地址值</span><br><span class="line">System.out.println(student1.equals(student2));</span><br></pre></td></tr></table></figure>
<h1 id="总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。-—习近平"><a href="#总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。-—习近平" class="headerlink" title="总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。   —习近平"></a>总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。   —习近平</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/29/javabianliang/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/29/javabianliang/" itemprop="url">java变量的存储位置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-29T20:30:16+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Java变量的存储位置对理解-和equals-很重要"><a href="#Java变量的存储位置对理解-和equals-很重要" class="headerlink" title="Java变量的存储位置对理解==和equals()很重要"></a>Java变量的存储位置对理解==和equals()很重要</h1><p>1，栈：存放基本类型的变量数据和对象（String和自定义的对象等都算对像）的引用<br>2，常量池：存放字符串常量和基本类型常量（public static final)<br>3，堆：存放所有new出来的对像<br>4，静态域：存放静态成员（static定义的）</p>
<h1 id="对于字符串："><a href="#对于字符串：" class="headerlink" title="对于字符串："></a>对于字符串：</h1><pre><code>其对象的引用都是存储在栈中的，如果是编译期已经创建好(直接用双引号定义的)的就存储在常量池中，
如果是运行期（new出来的）才能确定的就存储在堆中。
对于equals相等的字符串，在常量池中永远只有一份，在堆中有多份。
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String s1 = &quot;china&quot;;  </span><br><span class="line">String s2 = &quot;china&quot;;  </span><br><span class="line">String s3 = &quot;china&quot;;  </span><br><span class="line">String ss1 = new String(&quot;china&quot;);  </span><br><span class="line">String ss2 = new String(&quot;china&quot;);  </span><br><span class="line">String ss3 = new String(&quot;china&quot;);</span><br></pre></td></tr></table></figure>
<pre><code>对于通过new产生一个字符串（假设为”china”）时，会先去常量池中查找是否已经有了”china”对象，
如果没有则在常量池中创建一个此字符串对象，然后堆中再创建一个常量池中此”china”对象的拷贝对象。
这也就是有道面试题：String s = new String(“xyz”);产生几个对象？
一个或两个，如果常量池中原来没有”xyz”,就是两个。
</code></pre><h1 id="对于基础类型的变量和常量：变量和引用存储在栈中，常量存储在常量池中"><a href="#对于基础类型的变量和常量：变量和引用存储在栈中，常量存储在常量池中" class="headerlink" title="对于基础类型的变量和常量：变量和引用存储在栈中，常量存储在常量池中"></a>对于基础类型的变量和常量：变量和引用存储在栈中，常量存储在常量池中</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int i1 = 9;  </span><br><span class="line">int i2 = 9;  </span><br><span class="line">int i3 = 9;   </span><br><span class="line">public static final int INT1 = 9;  </span><br><span class="line">public static final int INT2 = 9;  </span><br><span class="line">public static final int INT3 = 9;</span><br></pre></td></tr></table></figure>
<pre><code>对于成员变量和局部变量：成员变量就是方法外部，类的内部定义的变量；局部变量就是方法或语句块内部定义的变量。局部变量必须初始化。 
形式参数是局部变量，局部变量的数据存在于栈内存中。栈内存中的局部变量随着方法的消失而消失。 
成员变量存储在堆中的对象里面，由垃圾回收器负责回收。
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">class BirthDate &#123;  </span><br><span class="line">	private int day;  </span><br><span class="line">	private int month;  </span><br><span class="line">	private int year;      </span><br><span class="line">	public BirthDate(int d, int m, int y) &#123;  </span><br><span class="line">		day = d;   </span><br><span class="line">		month = m;   </span><br><span class="line">		year = y;  </span><br><span class="line">    &#125;  </span><br><span class="line">//   省略get,set方法………  </span><br><span class="line">&#125;  </span><br><span class="line"> </span><br><span class="line">public class Test&#123;  </span><br><span class="line">	public static void main(String args[])&#123;  </span><br><span class="line">		int date = 9;  </span><br><span class="line">		Test test = new Test();</span><br><span class="line">		test.change(date);   </span><br><span class="line">		BirthDate d1= new BirthDate(2,19,1993);         </span><br><span class="line">	&#125;    </span><br><span class="line">	public void change(int i)&#123;  </span><br><span class="line">		i = 1234;  </span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于以上这段代码，date为局部变量，i,d,m,y都是形参为局部变量，day，month，year为成员变量。下面分析一下代码执行时候的变化： </p>
<ol>
<li>main方法开始执行：int date = 9;<br> date局部变量，基础类型，引用和值都存在栈中。 </li>
<li>Test test = new Test();<br> test为对象引用，存在栈中，对象(new Test())存在堆中。 </li>
<li>test.change(date);<br> i为局部变量，引用和值存在栈中。当方法change执行完成后，i就会从栈中消失。 </li>
<li>BirthDate d1= new BirthDate(7,7,1970);<br> d1为对象引用，存在栈中，对象(new BirthDate())存在堆中，其中d，m，y为局部变量存储在栈中，且它们的类型为基础类型，因此它们的数据也存储在栈中。<br> day,month,year为成员变量，它们存储在堆中(new BirthDate()里面)。当BirthDate构造方法执行完之后，d,m,y将从栈中消失。</li>
<li>main方法执行完之后，date变量，test，d1引用将从栈中消失，new Test(),new BirthDate()将等待垃圾回收。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/29/objectCreate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tanhq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog_logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tanhq's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/29/objectCreate/" itemprop="url">创建对象的几种方式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-29T19:09:48+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近去面试，好几次被问到创建对象的几种方式，所以在这里总结一下</p>
<h1 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">package com.gcms.ref;</span><br><span class="line"></span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">public class Employee implements Cloneable, Serializable&#123;</span><br><span class="line"></span><br><span class="line">	private static final long serialVersionUID = 1L;</span><br><span class="line">	private String name;</span><br><span class="line">	public String getName() &#123;</span><br><span class="line">		return name;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setName(String name) &#123;</span><br><span class="line">		this.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	public Employee() &#123;</span><br><span class="line">		 System.out.println(&quot;Employee Constructor Called...&quot;);   </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Override</span><br><span class="line">	public int hashCode() &#123;</span><br><span class="line">		final int prime = 31;</span><br><span class="line">		int result = 1;</span><br><span class="line">		result = prime * result + ((name == null) ? 0 : name.hashCode());</span><br><span class="line">		return result;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public boolean equals(Object obj) &#123;</span><br><span class="line">		if (this == obj)</span><br><span class="line">			return true;</span><br><span class="line">		if (obj == null)</span><br><span class="line">			return false;</span><br><span class="line">		if (getClass() != obj.getClass())</span><br><span class="line">			return false;</span><br><span class="line">		Employee other = (Employee) obj;</span><br><span class="line">		if (name == null) &#123;</span><br><span class="line">			if (other.name != null)</span><br><span class="line">				return false;</span><br><span class="line">		&#125; else if (!name.equals(other.name))</span><br><span class="line">			return false;</span><br><span class="line">		return true;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public String toString() &#123;</span><br><span class="line">		return &quot;Employee [name=&quot; + name + &quot;]&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//重写Object对象的clone()方法</span><br><span class="line">	@Override</span><br><span class="line">	protected Object clone()  &#123;</span><br><span class="line">		Object object = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			object = super.clone();</span><br><span class="line">		&#125; catch (CloneNotSupportedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		return object;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="测试类"><a href="#测试类" class="headerlink" title="测试类"></a>测试类</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">package com.gcms.ref;</span><br><span class="line"></span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.ObjectInputStream;</span><br><span class="line">import java.io.ObjectOutputStream;</span><br><span class="line">import java.lang.reflect.Constructor;</span><br><span class="line">import java.lang.reflect.InvocationTargetException;</span><br><span class="line"></span><br><span class="line">public class ObjectCreation &#123;</span><br><span class="line">	</span><br><span class="line">	public static void main(String[] args) throws </span><br><span class="line">		InstantiationException, IllegalAccessException, </span><br><span class="line">		ClassNotFoundException, NoSuchMethodException, SecurityException, </span><br><span class="line">		IllegalArgumentException, InvocationTargetException, </span><br><span class="line">		FileNotFoundException, IOException &#123;</span><br><span class="line">		</span><br><span class="line">		//1,new对象,调用构造方法</span><br><span class="line">		Employee emp1 = new Employee();</span><br><span class="line">		emp1.setName(&quot;tanhq&quot;);</span><br><span class="line">		System.out.println(emp1+&quot;, hashCode = &quot;+emp1.hashCode());</span><br><span class="line">		</span><br><span class="line">		//2，使用class对象的newInstance()方法,调用构造方法</span><br><span class="line">//		Employee emp2 = Employee.class.newInstance();</span><br><span class="line">		Employee emp2 = (Employee) Class.forName(&quot;com.gcms.ref.Employee&quot;).newInstance();</span><br><span class="line">		emp2.setName(&quot;Rishi&quot;);   </span><br><span class="line">        System.out.println(emp2 + &quot;, hashcode = &quot; + emp2.hashCode());  </span><br><span class="line">        </span><br><span class="line">        //3，使用Constructor对象的newInstance()方法</span><br><span class="line">        Constructor&lt;Employee&gt; constructor = Employee.class.getConstructor();</span><br><span class="line">        Employee emp3 = constructor.newInstance();</span><br><span class="line">        emp3.setName(&quot;Yogesh&quot;);   </span><br><span class="line">        System.out.println(emp3 + &quot;, hashcode = &quot; + emp3.hashCode());  </span><br><span class="line">        </span><br><span class="line">        /**</span><br><span class="line">         * 4,调用对象的clone()方法，jvm会创建一个新对象，将前面对象的内容全部拷贝进去。</span><br><span class="line">         *   使用clone()方法创建对象并不会调用任何构造函数</span><br><span class="line">         */</span><br><span class="line">        Employee emp4 = (Employee) emp3.clone();</span><br><span class="line">        emp4.setName(&quot;laomao&quot;);</span><br><span class="line">        System.out.println(emp4 + &quot;, hashcode = &quot; + emp3.hashCode());</span><br><span class="line">        </span><br><span class="line">        /**</span><br><span class="line">         * 5,使用序列化和反序列化，jvm会给我们创建一个单独的对象，jvm不会调用任何构造函数</span><br><span class="line">         * 序列化：把对象转换为 &quot;字节序列&quot; 的过程称为对象的序列化</span><br><span class="line">		 * 反序列化：把 &quot;字节序列&quot; 恢复为对象的过程称为对象的反序列化</span><br><span class="line">         */</span><br><span class="line">        //使用对象输出流ObjectOutputStream 将emp4 输出到data.txt文件中</span><br><span class="line">        ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(&quot;d:\\data.txt&quot;));</span><br><span class="line">        out.writeObject(emp4);</span><br><span class="line">        out.close();</span><br><span class="line">        </span><br><span class="line">        //使用对象输入流ObjectInputStream将emp4写入</span><br><span class="line">        ObjectInputStream input = new ObjectInputStream(new FileInputStream(&quot;d:\\data.txt&quot;));</span><br><span class="line">        Employee emp5 = (Employee) input.readObject();</span><br><span class="line">        input.close();</span><br><span class="line">        emp5.setName(&quot;fangliang&quot;);</span><br><span class="line">        System.out.println(emp5 + &quot;,hashCode = &quot; + emp5.hashCode());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="控制台打印"><a href="#控制台打印" class="headerlink" title="控制台打印"></a>控制台打印</h1><p>  <img src="/2018/04/29/objectCreate/objectCreate.png" alt="结果"></p>
<h1 id="总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。-—习近平在世界经济论坛2017年年会开幕式上的主旨演讲"><a href="#总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。-—习近平在世界经济论坛2017年年会开幕式上的主旨演讲" class="headerlink" title="总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。               —习近平在世界经济论坛2017年年会开幕式上的主旨演讲"></a>总结：历史是勇敢者创造的，让我们拿出信心，采取行动，携手向着未来前进。               —习近平在世界经济论坛2017年年会开幕式上的主旨演讲</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/blog_logo.jpg"
                alt="tanhq" />
            
              <p class="site-author-name" itemprop="name">tanhq</p>
              <p class="site-description motion-element" itemprop="description">java 后端开发</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tanhq</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>



<br/>
<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
